<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ambient Timer</title>
  <link rel="icon" href="assests/icon.png">
  <link rel="stylesheet" href="style.css?v=20260204i">
</head>

<body>

  <!-- Hidden Canvas (optional future use) -->
  <canvas id="brightnessCanvas" style="display:none;"></canvas>

  <!-- Background Video (dual-layer for seamless crossfade) -->
  <video id="bgVideoA" class="bg-video" autoplay muted playsinline preload="auto"></video>
  <video id="bgVideoB" class="bg-video" autoplay muted playsinline preload="auto"></video>

  <!-- Background Image Layers -->
  <div id="bgImageA" class="bg-image active" style="background-image:url('images/bg.jpg')"></div>
  <div id="bgImageB" class="bg-image"></div>

  <!-- Page 1 Tint -->
  <div id="pageTint" class="page-tint"></div>

  <!-- Alarm Sound -->
  <audio id="alarmSound" src="assests/alarm.mp3" preload="auto"></audio>

  <!-- Confirm Delete Modal -->
  <div id="confirmOverlay" class="confirm-overlay" aria-hidden="true">
    <div class="confirm-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <h3 id="confirmTitle">Delete theme?</h3>
      <p id="confirmMessage">This cannot be undone.</p>
      <div class="confirm-actions">
        <button id="confirmCancel" class="confirm-btn ghost">Cancel</button>
        <button id="confirmOk" class="confirm-btn danger">Delete</button>
      </div>
    </div>
  </div>

  <!-- Top Bar -->
  <div id="topBar" class="top-bar" aria-hidden="true">
    <div class="top-left">
      <img src="images/logo.png" alt="Ambient Timer" class="logo-img">
    </div>
    <div class="top-center">
      <input id="themeSearch" class="search-input" type="search" placeholder="Search themes...">
    </div>
    <div class="top-right">
      <button id="burgerBtn" class="burger-btn" aria-label="Menu">☰</button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobileMenu" class="mobile-menu" aria-hidden="true">
    <div class="mobile-menu-panel" role="dialog" aria-modal="true" aria-label="Menu">
      <div class="mobile-menu-header">
        <span>Menu</span>
        <button id="mobileMenuClose" class="icon-btn" aria-label="Close">&#10005;</button>
      </div>
      <div id="mobileSearchWrap" class="mobile-search">
        <input id="mobileSearchInput" class="search-input" type="search" placeholder="Search themes...">
      </div>
      <div class="mobile-menu-actions">
        <button id="mobileMenuHomeBtn" class="menu-btn">Home</button>
        <button id="mobileMenuSettingsBtn" class="menu-btn">Settings</button>
        <button id="mobileMenuLoginBtn" class="menu-btn">Log in</button>
        <button id="mobileMenuSignupBtn" class="menu-btn">Sign up</button>
        <button id="mobileMenuLogoutBtn" class="menu-btn danger">Log out</button>
      </div>
    </div>
  </div>

  <!-- Profile Menu (Pages 1 & 2 only) -->
  <div id="profileShell" class="profile-shell" aria-hidden="true">
    <button id="profileBtn" class="profile-btn" aria-haspopup="true" aria-expanded="false">
      <span id="profileAvatar" class="profile-avatar">A</span>
    </button>
    <div id="profileMenu" class="profile-menu" role="menu">
      <div class="profile-mini">
        <div id="profileMiniAvatar" class="profile-avatar sm">A</div>
        <div>
          <div id="profileName" class="profile-name">Guest</div>
          <div id="profileEmail" class="profile-email">Not signed in</div>
        </div>
      </div>
      <div class="profile-actions">
        <button id="profileSettingsBtn" class="menu-btn" style="display:none">Settings</button>
        <button id="profileLoginBtn" class="menu-btn">Log in</button>
        <button id="profileSignupBtn" class="menu-btn">Sign up</button>
        <button id="profileLogoutBtn" class="menu-btn danger" style="display:none">Log out</button>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div id="authOverlay" class="auth-overlay" aria-hidden="true">
    <div class="auth-card" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <div class="auth-header">
        <h3 id="authTitle">Welcome back</h3>
        <button id="authCloseBtn" class="icon-btn" aria-label="Close">✕</button>
      </div>
      <div class="auth-tabs">
        <button id="authTabLogin" class="tab-btn active">Log in</button>
        <button id="authTabSignup" class="tab-btn">Sign up</button>
      </div>
      <div class="auth-body">
        <div id="authConfirmBox" class="auth-confirm">
          Please check your email to confirm your account.
        </div>
        <div id="authResendWrap" class="auth-resend">
          <button id="authResendBtn" class="link-btn">Didn’t get it? Resend</button>
        </div>
        <div class="field">
          <label for="authEmail">Email</label>
          <input id="authEmail" name="email" type="email" placeholder="you@email.com" autocomplete="username" autocapitalize="none" spellcheck="false">
        </div>
        <div class="field auth-signup-only">
          <label for="authDisplayName">Display name</label>
          <input id="authDisplayName" name="name" type="text" placeholder="Your name" autocomplete="name">
        </div>
        <div class="field">
          <label for="authPassword">Password</label>
          <input id="authPassword" name="new-password" type="password" placeholder="••••••••" autocomplete="new-password">
        </div>
        <div class="field auth-signup-only">
          <label for="authPasswordConfirm">Confirm password</label>
          <input id="authPasswordConfirm" name="confirm_password" type="password" placeholder="••••••••" autocomplete="off" data-lpignore="true" data-1p-ignore="true">
        </div>
        <div class="auth-or">or</div>
        <button id="authGoogleBtn" class="google-btn">Continue with Google</button>
        <button id="authSubmitBtn" class="primary-btn">Continue</button>
        <p id="authMessage" class="auth-message"></p>
      </div>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- Orientation Overlay (Mobile) -->
  <div id="orientationOverlay" class="orientation-overlay" aria-hidden="true">
    <div class="orientation-card">
      <div id="orientationMessage">Rotate your device</div>
    </div>
  </div>

  <!-- ============================= -->
  <!-- HOME: Welcome -->
  <!-- ============================= -->
  <div id="pageHome" class="page">
    <div class="page-content home-content">
      <img src="images/logo.png" alt="Ambient Timer" class="home-logo">
      <div id="homeGuest" class="home-actions">
        <button id="homeTimerBtn" class="primary-btn">Timer</button>
        <button id="homeSignupBtn" class="ghost-btn">Create account</button>
      </div>
      <div id="homeAuthed" class="home-welcome">
        <div class="welcome-text">Welcome back,</div>
        <div id="homeUsername" class="welcome-name">Friend</div>
        <button id="homeGoThemesBtn" class="primary-btn">Go to theme selection</button>
      </div>
    </div>
    <div class="version-tag">[1.25]</div>
  </div>

  <!-- ============================= -->
  <!-- PAGE 1: Background Selection -->
  <!-- ============================= -->
  <div id="page1" class="page">
    <div class="page-content">
      <h1>Choose Your Atmosphere</h1>
      <p class="preview-hint" data-hint="hover">Hover over themes for preview</p>
      <div id="themeViewControls" class="view-controls">
        <button id="viewDefaultBtn" class="view-btn active" data-tip="Default view" aria-label="Default view">&#9638;</button>
        <button id="viewUploadsBtn" class="view-btn" data-tip="Uploads view" aria-label="Uploads view">&#8801;</button>
        <button id="viewAllBtn" class="view-btn" data-tip="All themes view" aria-label="All themes view">&#9635;</button>
      </div>
      <div id="allThemesSortWrap" class="sort-wrap" hidden>
        <select id="allThemesSort" class="sort-select">
          <option value="name">Sort by name</option>
          <option value="date">Sort by date added</option>
          <option value="recent">Sort by recently used</option>
          <option value="used">Sort by most used themes</option>
        </select>
        <button id="allThemesFilterBtn" class="filter-btn" type="button" aria-expanded="false">Filter</button>
        <div id="allThemesFilterPanel" class="filter-panel" hidden>
          <label class="filter-option">
            <input id="filterVideo" type="checkbox" checked>
            <span>Videos</span>
          </label>
          <label class="filter-option">
            <input id="filterImage" type="checkbox" checked>
            <span>Images</span>
          </label>
        </div>
      </div>
      <h2 id="searchHeader" class="section-title search-title">Search:</h2>

      <div id="recentSection" hidden>
        <h2 class="section-title">Recent Themes</h2>
        <div class="grid default-grid" id="recentThemesGrid"></div>
      </div>

      <div id="builtInSection">
      <h2 class="section-title">Built-in Themes</h2>
      <div class="grid default-grid" id="defaultThemes">

        <div class="thumb"
          data-name="Yamato"
          data-src="videos/one.mp4"
          data-type="video"
          style="background-image:url('images/one.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Yamato</span>
          </div>
        </div>

        <div class="thumb"
          data-name="Minecraft Cabin"
          data-src="videos/two.mp4"
          data-type="video"
          style="background-image:url('images/two.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Minecraft Cabin</span>
          </div>
        </div>

        <div class="thumb"
          data-name="Cabin in Rain"
          data-src="videos/three.mp4"
          data-type="video"
          style="background-image:url('images/three.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Cabin in Rain</span>
          </div>
        </div>

        <div class="thumb"
          data-name="A stormy train ride"
          data-src="videos/four.mp4"
          data-type="video"
          style="background-image:url('images/four.png')">
          <div class="thumb-meta">
            <span class="thumb-name">A stormy train ride</span>
          </div>
        </div>

        <div class="thumb"
          data-name="Dark Atmospheric Room"
          data-src="videos/five.mp4"
          data-type="video"
          style="background-image:url('images/five.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Dark Atmospheric Room</span>
          </div>
        </div>

        <div class="thumb"
          data-name="Toji Fushigoro"
          data-src="videos/six.mp4"
          data-type="video"
          style="background-image:url('images/six.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Toji Fushigoro</span>
          </div>
        </div>

        <div class="thumb"
          data-name="Reze Flowerbed"
          data-src="videos/seven.mp4"
          data-type="video"
          style="background-image:url('images/seven.png')">
          <div class="thumb-meta">
            <span class="thumb-name">Reze Flowerbed</span>
          </div>
        </div>

      </div>
      </div>

      <div id="uploadsSection" class="section-panel panel-stack">
        <div id="localPanelBlock" class="panel-block">
          <h2 class="section-title">Your Themes</h2>
        <div class="controls panel-controls">
          <div class="controls-main">
            <div class="upload-group">
              <label class="upload">
                Upload Files
                <input id="localUploadInput" type="file"
                  accept="video/mp4,image/png,image/jpeg,.pkg"
                  multiple>
              </label>
              <div class="upload-dropdown">
                <button id="uploadMenuBtn" class="add-btn mini">▾</button>
                <div id="uploadMenu" class="upload-menu">
                  <button id="uploadFolderBtn" class="menu-btn">Upload Folder</button>
                </div>
              </div>
              <input id="localFolderInput" type="file"
                accept="video/mp4,image/png,image/jpeg,.pkg"
                multiple webkitdirectory directory hidden>
            </div>
          </div>
          <div class="controls-side">
            <button id="localMultiBtn" class="add-btn multi-btn">Multi-select</button>
            <button id="localDeleteBtn" class="add-btn danger delete-selected" disabled>Delete selected</button>
          </div>
        </div>
        <div class="grid auto-grid" id="localThemesGrid"></div>
      </div>

        <div id="onlinePanelBlock" class="panel-block">
          <h2 class="section-title">Online Themes</h2>
        <div class="controls panel-controls">
          <div class="controls-main">
            <input id="onlineUrlInput" class="url-input" type="text"
              placeholder="Paste an image or video URL (.jpg, .png, .mp4)">
            <button id="addOnlineThemeBtn" class="add-btn">Add URL</button>
          </div>
          <div class="controls-side">
            <button id="onlineMultiBtn" class="add-btn multi-btn">Multi-select</button>
            <button id="onlineDeleteBtn" class="add-btn danger delete-selected" disabled>Delete selected</button>
          </div>
        </div>
        <div class="grid auto-grid" id="onlineThemesGrid"></div>
      </div>
      </div>

      <div id="allThemesSection" class="section-panel" hidden>
        <h2 class="section-title">All Themes</h2>
        <div class="grid auto-grid" id="allThemesGrid"></div>
      </div>
    </div>
    <div class="version-tag">[1.25]</div>
  </div>

  <!-- ============================= -->
  <!-- PAGE 2: Time Selection -->
  <!-- ============================= -->
  <div id="page2" class="page">
    <div class="page-content">
      <button id="timeBackBtn" class="back-btn">Go back</button>
      <h1>Set Your Time</h1>

      <div class="time-grid">
        <button onclick="startTimer(60)">1 Hour</button>
        <button onclick="startTimer(90)">1h 30m</button>
        <button onclick="startTimer(120)">2 Hours</button>
        <button onclick="startTimer(150)">2h 30m</button>
      </div>

      <!-- Custom Time -->
      <div class="custom">
        <p>Or set your own:</p>

        <div class="custom-inputs">
          <input id="customHours" type="number" placeholder="Hours" min="0">
          <input id="customMinutes" type="number" placeholder="Minutes" min="0">
          <input id="customSeconds" type="number" placeholder="Seconds" min="0">
        </div>

        <button class="startCustom" onclick="startCustomTimer()">Start</button>
      </div>
    </div>
    <div class="version-tag">[1.25]</div>
  </div>

  <!-- ============================= -->
  <!-- PAGE 4: Settings -->
  <!-- ============================= -->
  <div id="pageSettings" class="page settings-page">
    <div class="page-content">
      <div class="settings-header">
        <button id="settingsBackBtn" class="icon-btn">←</button>
        <h1>Profile Settings</h1>
      </div>

      <div class="settings-card">
        <div class="settings-row">
          <div class="avatar-wrap">
            <img id="settingsAvatar" class="settings-avatar" alt="Profile avatar">
            <div id="settingsAvatarFallback" class="settings-avatar fallback">A</div>
          </div>
          <div class="settings-actions">
            <label class="upload small">
              Change photo
              <input id="settingsAvatarInput" type="file" accept="image/png,image/jpeg">
            </label>
            <p class="muted">Square images look best.</p>
          </div>
        </div>

        <div class="settings-grid">
          <div class="field">
            <label for="settingsDisplayName">Display name</label>
            <input id="settingsDisplayName" type="text" placeholder="Your name">
          </div>
          <div class="field">
            <label for="settingsEmail">Email</label>
            <input id="settingsEmail" type="email" placeholder="you@email.com">
          </div>
          <div class="field">
            <label id="settingsPasswordLabel">Change password</label>
            <button id="settingsPasswordBtn" class="add-btn">Send password email</button>
            <p id="settingsPasswordHint" class="muted">We’ll email you a secure link.</p>
          </div>
        </div>

        <button id="settingsSaveBtn" class="primary-btn">Save changes</button>
        <button id="settingsDeleteBtn" class="add-btn danger">Delete account</button>
        <p id="settingsMessage" class="auth-message"></p>
      </div>
    </div>
    <div class="version-tag">[1.25]</div>
  </div>

  <!-- ============================= -->
  <!-- PAGE 3: Timer Display -->
  <!-- ============================= -->
  <div id="timerBox" class="page">
    <button id="timerBackBtn" class="back-btn">Go back</button>
    <div id="timerDisplay">00:00</div>
    <div id="timerHint" class="timer-hint" aria-live="polite">
      <span>Click the timer to pause/unpause</span>
      <button id="timerHintClose" class="icon-btn" aria-label="Close">×</button>
    </div>
  </div>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js?v=20260204i"></script>

</body>
</html>
